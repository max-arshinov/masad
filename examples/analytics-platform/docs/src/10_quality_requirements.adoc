ifndef::imagesdir[:imagesdir: ../images]

[[section-quality-scenarios]]
== Quality Requirements

=== Quality Tree

- Reports and charts must be delivered within 1.5 seconds for any combination of parameters over a period not exceeding 3 months. [QA: P-1]
- The system must be able to serve approximately 100 billion events per day. [QA: S-1]
- Delays of 50–100 minutes are acceptable between a user action and its appearance in statistics. [QA: P-2]
- Data per website must be stored “forever.” [QA: R-1]

[options="header",cols="1,2,2,3,1"]
|===
| ID | Quality Attribute | Scenario | Fit Criteria (measurable) | Priority
| P-1 | Performance | Report latency | P95 ≤1.5s for queries over ≤3 months of data; P99 ≤2.5s; timeout rate <0.1% | High
| P-2 | Performance | Data freshness | Newly ingested events visible in dashboards ≤100 min end-to-end; P95 ≤60 min | Medium
| S-1 | Scalability | Ingestion throughput | Sustain ~100B events/day (~1.16M/s avg) with 3x peak for ≥10 min; 0% data loss; write error rate <0.01% | High
| R-1 | Retention | Data retention | Hot tier retains ≥3 months; warm/cold tier indefinite; restore from cold ≤24h; integrity verified (checksum) | High
|===

=== Quality Scenarios

==== P-1 Report latency
[options="header",cols="1,4"]
|===
| Source | Analyst user
| Stimulus | Requests a chart/report aggregating up to 3 months of events with filters and grouping
| Environment | Normal load; cache miss allowed; no precomputed materialization required
| Artifact | Query API, aggregation service, hot analytical store
| Response | Execute query and return complete chart data without timeout
| Response Measure | P95 latency ≤1.5s; P99 ≤2.5s; error rate <0.1%
|===

==== P-2 Data freshness
[options="header",cols="1,4"]
|===
| Source | Website/app SDKs via ingestion pipeline
| Stimulus | New events are produced continuously and ingested
| Environment | Multi-tenant, rolling deploys, normal operations; regional variability allowed
| Artifact | Ingestion API, queues/stream, ETL/aggregation, serving store
| Response | Ingest, process, and publish events to the serving store so they become queryable
| Response Measure | End-to-end freshness P95 ≤60 min, P99 ≤100 min; 0% permanent loss
|===

==== S-1 Ingestion throughput
[options="header",cols="1,4"]
|===
| Source | Global website/app SDKs and batch importers
| Stimulus | Sustained traffic of ~100B events/day (~1.16M events/s avg) with bursts up to 3x
| Environment | Multi-region, autoscaling enabled, occasional node failures and rolling deploys
| Artifact | Ingestion API, load balancers, message bus/stream, writers
| Response | Accept and enqueue events with backpressure, scale horizontally, and write to storage without loss
| Response Measure | Sustain ≥1.16M/s avg and ≥3.0M/s for ≥10 min; 0% data loss; ingest-side error rate <0.01%
|===

==== R-1 Data retention
[options="header",cols="1,4"]
|===
| Source | Compliance officer or analyst
| Stimulus | Requests access to event data older than 12 months for a tenant
| Environment | Normal operations; data resides in warm/cold tier
| Artifact | Storage subsystem, lifecycle management, restore service
| Response | Locate and retrieve requested data from warm/cold tier and make it queryable
| Response Measure | Hot tier keeps ≥3 months; warm/cold retention is indefinite; restore SLA ≤24h; integrity 100% (checksum verified)
|===
